<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ø§Ø®ØªØµØ§ØµÛŒ Ù…Ù†</title>
    <style>
        body { background: #000; color: #fff; margin: 0; font-family: Tahoma, sans-serif; overflow: hidden; }
        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); 
                   display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; cursor: pointer; }
        .btn-start { padding: 20px 40px; background: #e50914; color: white; border: none; border-radius: 5px; font-size: 20px; font-weight: bold; cursor: pointer; }
        #player-container { width: 100vw; height: 100vh; }
        video { width: 100%; height: 100%; background: #000; }
        #status-bar { position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.5); padding: 10px; font-size: 12px; }
    </style>
</head>
<body>

<div id="overlay">
    <button class="btn-start">ğŸ”´ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ø®Ø´ Ø²Ù†Ø¯Ù‡ Ø´Ø¨Ú©Ù‡</button>
    <p style="margin-top: 20px;">Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø¨Ø§ Ø²Ù…Ø§Ù† Ù¾Ø®Ø´ØŒ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</p>
</div>

<div id="player-container">
    <video id="tvPlayer" controls preload="auto"></video>
</div>

<div id="status-bar" id="info">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>

<script>
    // --- Ø¨Ø®Ø´ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø´Ù…Ø§ ---
    const playlist = [
        { 
            url: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4', 
            duration: 596, 
            title: 'ÙÛŒÙ„Ù… Ø³ÛŒÙ†Ù…Ø§ÛŒÛŒ Closer' 
        },
        { 
            url: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4', 
            duration: 596, 
            title: 'Ù†Ø§Ù… ÙÛŒÙ„Ù… Ø¯ÙˆÙ…' 
        }
        // Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±ÛŒ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯
    ];

    // ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ Ú©Ù„ Ø´Ø¨Ú©Ù‡ (Ø§ÛŒÙ† ØªØ§Ø±ÛŒØ® Ø±Ø§ ØªØºÛŒÛŒØ± Ù†Ø¯Ù‡ÛŒØ¯ ØªØ§ Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ Ø«Ø§Ø¨Øª Ø¨Ù…Ø§Ù†Ø¯)
    const epochStart = new Date('2024-01-01T00:00:00').getTime() / 1000;
    // -----------------------

    const player = document.getElementById('tvPlayer');
    const overlay = document.getElementById('overlay');
    const info = document.getElementById('status-bar');

    function syncStream() {
        const now = Date.now() / 1000;
        const totalPlaylistTime = playlist.reduce((acc, movie) => acc + movie.duration, 0);
        
        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø«Ø§Ù†ÛŒÙ‡ ÙØ¹Ù„ÛŒ Ø¯Ø± Ú†Ø±Ø®Ù‡ Ú©Ù„ Ù„ÛŒØ³Øª Ù¾Ø®Ø´
        let elapsedTotal = (now - epochStart) % totalPlaylistTime;
        
        let cumulativeTime = 0;
        for (let movie of playlist) {
            if (elapsedTotal < cumulativeTime + movie.duration) {
                const currentSeekTime = elapsedTotal - cumulativeTime;
                
                // ØªØºÛŒÛŒØ± ÙÛŒÙ„Ù… ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±ØªÛŒ Ú©Ù‡ ÙÛŒÙ„Ù… ÙØ¹Ù„ÛŒ Ù†Ø¨Ø§Ø´Ø¯
                if (player.dataset.currentUrl !== movie.url) {
                    player.src = movie.url;
                    player.dataset.currentUrl = movie.url;
                    player.currentTime = currentSeekTime;
                }

                // Ù‡Ù…Ø§Ù‡Ù†Ú¯â€ŒØ³Ø§Ø²ÛŒ Ø²Ù…Ø§Ù† Ø§Ú¯Ø± Ø§Ø®ØªÙ„Ø§Ù Ø²ÛŒØ§Ø¯ Ø¨ÙˆØ¯ (Ø¨ÛŒØ´ Ø§Ø² Û³ Ø«Ø§Ù†ÛŒÙ‡)
                if (Math.abs(player.currentTime - currentSeekTime) > 3) {
                    player.currentTime = currentSeekTime;
                }

                info.innerText = Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´: ${movie.title} | Ø²Ù…Ø§Ù† Ù‡Ù…Ø§Ù‡Ù†Ú¯ Ø´Ø¯Ù‡: ${Math.floor(currentSeekTime)} Ø«Ø§Ù†ÛŒÙ‡;
                break;
            }
            cumulativeTime += movie.duration;
        }
    }

    // Ø´Ø±ÙˆØ¹ Ù¾Ø®Ø´ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ú©Ø§Ø±Ø¨Ø±
    overlay.addEventListener('click', () => {
        overlay.style.display = 'none';
        syncStream();
        player.play().catch(err => console.error("Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´:", err));
        
        // Ú†Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ù‡Ø± Ûµ Ø«Ø§Ù†ÛŒÙ‡ ÛŒÚ©Ø¨Ø§Ø±
        setInterval(syncStream, 5000);
    });

    // ÙˆÙ‚ØªÛŒ ÛŒÚ© ÙÛŒÙ„Ù… ØªÙ…Ø§Ù… Ø´Ø¯ØŒ Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ ÙÛŒÙ„Ù… Ø¨Ø¹Ø¯ÛŒ Ø±Ø§ Ú†Ú© Ú©Ù†
    player.onended = () => {
        syncStream();
        player.play();
    };
</script>

</body>
</html>
