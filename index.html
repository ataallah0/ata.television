<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ† Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¹Ø·Ø§Ø§Ù„Ù„Ù‡</title>
    <style>
        body { background: #000; color: #fff; margin: 0; font-family: Tahoma, sans-serif; overflow: hidden; text-align: center; }
        #start-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 100;
        }
        .play-btn {
            padding: 20px 50px; background: #e50914; color: #fff;
            border: none; border-radius: 50px; font-size: 24px;
            font-weight: bold; cursor: pointer; transition: 0.3s;
        }
        .play-btn:hover { background: #ff0a16; transform: scale(1.1); }
        #player-container { width: 100vw; height: 100vh; }
        video { width: 100%; height: 100%; background: #000; }
        #info { position: absolute; bottom: 20px; width: 100%; text-shadow: 2px 2px 4px #000; color: #ccc; font-size: 14px; }
    </style>
</head>
<body>

    <div id="start-screen">
        <h1 style="margin-bottom: 30px;">Ø¨Ù‡ Ø´Ø¨Ú©Ù‡ ØªÙ„ÙˆÛŒØ²ÛŒÙˆÙ†ÛŒ Ø¹Ø·Ø§Ø§Ù„Ù„Ù‡ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯</h1>
        <button class="play-btn" onclick="startBroadcast()">ğŸ”´ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ù¾Ø®Ø´ Ø²Ù†Ø¯Ù‡</button>
        <p style="color: #888; margin-top: 20px;">(Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ ØµØ¯Ø§ Ùˆ ØªØµÙˆÛŒØ± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯)</p>
    </div>

    <div id="player-container">
        <video id="tvPlayer" playsinline controls></video>
    </div>

    <div id="info">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>

    <script>
        // Û±. Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯
        const playlist = [
            { 
                url: 'https://s3.irdanlod.ir/Animation/2004/T/The.Incredibles.2004.720p.x265.HEVC.Farsi.Dubbed.mkv', 
                duration: 6400, 
                title: 'Ø´Ú¯ÙØªâ€ŒØ§Ù†Ú¯ÛŒØ²Ø§Ù†' 
            },
            { 
                url: 'https://cdn2.uptv.ir/?s=11&f=film/Iron_Man_1_2008_1080p_UPTV.co.mkv', 
                duration: 6400, 
                title: 'Ø§ÛŒØ±ÙˆÙ† Ù…Ù† '
            }
            { 
                url: 'https://s3.irdanlod.ir/Animation/1995/T/Toy.Story.1995.720p.Farsi.Dubbed.mkv', 
                duration: 6400, 
                title: 'Ø§Ø³Ø¨Ø§Ø¨ Ø¨Ø§Ø²ÛŒ' 
            },
            
            { 
                url: 'https://s3.irdanlod.ir/Animation/1999/T/Toy.Story.2.1999.720p.Farsi.Dubbed.mkv', 
                duration: 6400, 
                title: '2Ø§Ø³Ø¨Ø§Ø¨ Ø¨Ø§Ø²ÛŒ' 
            },
            // Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ÙÛŒÙ„Ù…â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±ÛŒ Ø±Ø§ Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§ Ú©Ø±Ø¯Ù‡ Ùˆ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯
        ];

        const epochStart = new Date('2024-01-01T00:00:00').getTime() / 1000;
        const player = document.getElementById('tvPlayer');
        const startScreen = document.getElementById('start-screen');
        const info = document.getElementById('info');

        function syncTV() {
            const now = Date.now() / 1000;
            const totalDuration = playlist.reduce((a, b) => a + b.duration, 0);
            let elapsed = (now - epochStart) % totalDuration;

            let accumulated = 0;
            for (let movie of playlist) {
                if (elapsed < accumulated + movie.duration) {
                    const seekTime = elapsed - accumulated;
                    
                    if (player.src !== movie.url) {
                        player.src = movie.url;
                        player.load(); // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ù†Ø¨Ø¹ Ø¬Ø¯ÛŒØ¯
                    }
                    
                    // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù¾Ø±Ø´ Ù…Ø¯Ø§ÙˆÙ… ØªØµÙˆÛŒØ± (ÙÙ‚Ø· Ø§Ú¯Ø± Ø§Ø®ØªÙ„Ø§Ù Ø²ÛŒØ§Ø¯ Ø¨ÙˆØ¯ Ø¬Ø§Ø¨Ø¬Ø§ Ø´ÙˆØ¯)
                    if (Math.abs(player.currentTime - seekTime) > 3) {
                        player.currentTime = seekTime;
                    }
                    
                    info.innerText = "Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø®Ø´: " + movie.title;
                    break;
                }
                accumulated += movie.duration;
            }
        }

        function startBroadcast() {
            startScreen.style.display = 'none';
            syncTV();
            player.play().catch(error => {
                player.muted = true; // Ø§Ú¯Ø± Ø®Ø·Ø§ Ø¯Ø§Ø¯ØŒ Ø¨ÛŒâ€ŒØµØ¯Ø§ Ù¾Ø®Ø´ Ú©Ù† ØªØ§ Ø¨Ø§Ø² Ø´ÙˆØ¯
                player.play();
            });

            // Ù‡Ø± Ûµ Ø«Ø§Ù†ÛŒÙ‡ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø±Ø§ Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯
            setInterval(syncTV, 5000);
        }

        // ÙˆÙ‚ØªÛŒ ÛŒÚ© ÙÛŒÙ„Ù… ØªÙ…Ø§Ù… Ø´Ø¯ØŒ Ø¨Ù„Ø§ÙØ§ØµÙ„Ù‡ ÙÛŒÙ„Ù… Ø¨Ø¹Ø¯ÛŒ Ø±Ø§ Ú†Ú© Ú©Ù†
        player.onended = function() {
            syncTV();
            player.play();
        };
    </script>
</body>
</html>
